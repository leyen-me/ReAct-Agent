<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>贪吃蛇游戏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            min-height: 800px;
            margin: 0;
        }

        .container {
            text-align: center;
            margin: 20px;
            padding: 20px;
            border: 2px solid #333;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        canvas {
            border: 2px solid #333;
            margin: 10px auto;
            display: block;
        }

        .controls {
            margin: 20px 0;
        }

        button {
            padding: 10px 20px;
            margin: 0 5px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        button:hover {
            background-color: #45a049;
        }

        #pause {
            background-color: #2196F3;
        }

        #pause:hover {
            background-color: #0b7dda;
        }

        #reset {
            background-color: #f44336;
        }

        #reset:hover {
            background-color: #d32f2f;
        }

        .score {
            margin: 10px 0;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>贪吃蛇游戏</h1>
    <div class="container" id="gameContainer">
        <div class="score" id="scoreDisplay">得分: 0</div>
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div class="controls">
            <button id="start">开始游戏</button>
            <button id="pause">暂停游戏</button>
            <button id="reset">重新开始</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const startButton = document.getElementById('start');
            const pauseButton = document.getElementById('pause');
            const resetButton = document.getElementById('reset');
            const scoreDisplay = document.getElementById('scoreDisplay');

            // 游戏变量
            const gridSize = 20; // 每个格子的宽度
            let snake = [{x: 15, y: 15}]; // 蛇的初始位置
            let food = createFood();
            let dx = 1; // 水平方向
            let dy = 0; // 垂直方向
            let speed = 150; // 游戏速度
            let score = 0;
            let gameLoopInterval;
            let gameRunning = false;
            const tiles = 30; // 每个方向（水平和垂直）的格子数量

            // 创建食物
            function createFood() {
                return {
                    x: Math.floor(Math.random() * tiles),
                    y: Math.floor(Math.random() * tiles)
                };
            }

            // 绘制游戏元素
            function draw() {
                // 清空画布
                ctx.fillStyle = 'black';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // 绘制蛇
                snake.forEach((segment, index) => {
                    if (index === 0) {
                        // 蛇头
                        ctx.fillStyle = 'green';
                    } else {
                        // 蛇身
                        ctx.fillStyle = 'lightgreen';
                    }
                    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
                    
                    // 蛇身部分绘制内部细节
                    ctx.strokeStyle = 'darkgreen';
                    ctx.strokeRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
                });

                // 绘制食物
                ctx.fillStyle = 'red';
                ctx.beginPath();
                ctx.arc(
                    food.x * gridSize + gridSize/2,
                    food.y * gridSize + gridSize/2,
                    gridSize/2 - 1,
                    0,
                    Math.PI * 2
                );
                ctx.fill();
            }

            // 移动蛇
            function moveSnake() {
                const head = { x: snake[0].x + dx, y: snake[0].y + dy };
                
                // 检查边界碰撞（经典模式：碰到边界游戏结束）
                if (head.x < 0 || head.x >= tiles || head.y < 0 || head.y >= tiles) {
                    gameOver();
                    return;
                }

                // 检查自身碰撞（经典模式：碰到自己游戏结束）
                for (let i = 0; i < snake.length; i++) {
                    if (snake[i].x === head.x && snake[i].y === head.y) {
                        gameOver();
                        return;
                    }
                }

                snake.unshift(head);

                // 检查是否吃到食物
                if (head.x === food.x && head.y === food.y) {
                    score++;
                    scoreDisplay.textContent = '得分: ' + score;
                    food = createFood();
                } else {
                    snake.pop();
                }

                draw();
            }

            // 游戏主循环
            function gameLoop() {
                if (gameRunning) {
                    moveSnake();
                }
            }

            // 游戏结束
            function gameOver() {
                clearInterval(gameLoopInterval);
                gameRunning = false;
                startButton.textContent = '开始游戏';
                alert('游戏结束！得分: ' + score);
            }

            // 开始游戏
            function startGame() {
                if (!gameRunning) {
                    gameRunning = true;
                    startButton.textContent = '游戏中...';
                    gameLoopInterval = setInterval(gameLoop, speed);
                }
            }

            // 暂停游戏
            function pauseGame() {
                if (gameRunning) {
                    clearInterval(gameLoopInterval);
                    gameRunning = false;
                    startButton.textContent = '继续游戏';
                } else {
                    gameRunning = true;
                    startButton.textContent = '暂停游戏';
                    gameLoopInterval = setInterval(gameLoop, speed);
                }
            }

            // 重置游戏
            function resetGame() {
                clearInterval(gameLoopInterval);
                gameRunning = false;
                startButton.textContent = '开始游戏';
                score = 0;
                scoreDisplay.textContent = '得分: ' + score;
                snake = [{x: 15, y: 15}];
                dx = 1; dy = 0;
                food = createFood();
                draw();
            }

            // 键盘控制
            document.addEventListener('keydown', (e) => {
                switch (e.key) {
                    case 'ArrowUp':
                        if (dy === 0) { // 防止180度转向
                            dx = 0;
                            dy = -1;
                        }
                        break;
                    case 'ArrowDown':
                        if (dy === 0) {
                            dx = 0;
                            dy = 1;
                        }
                        break;
                    case 'ArrowLeft':
                        if (dx === 0) {
                            dx = -1;
                            dy = 0;
                        }
                        break;
                    case 'ArrowRight':
                        if (dx === 0) {
                            dx = 1;
                            dy = 0;
                        }
                        break;
                    case ' ':
                        pauseGame();
                        break;
                }
            });

            // 添加按钮事件监听
            startButton.addEventListener('click', startGame);
            pauseButton.addEventListener('click', pauseGame);
            resetButton.addEventListener('click', resetGame);

            // 初始化绘制
            draw();
        });
    </script>
</body>
</html>